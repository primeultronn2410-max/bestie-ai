<!DOCTYPE html>
<html>
<head>
  <title>Bestie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="
  margin:0;
  background:black;
  color:white;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:sans-serif;
  text-align:center;
">

  <div>
    <h2>Bestie ðŸ’–</h2>
    <p id="status">Tap anywhere</p>
    <p id="heard" style="margin-top:15px;color:#00ffcc;"></p>
    <p id="reply" style="margin-top:15px;color:#ff99cc;"></p>
  </div>

<script>
let started = false;
let recognition;

// ðŸ”‘ PUT YOUR GEMINI API KEY HERE
const GEMINI_KEY = "AIzaSyDxrhY27eCBBOR3EBLkchTApZEQCrZEFfg";

const SpeechRecognition =
  window.SpeechRecognition || window.webkitSpeechRecognition;

recognition = new SpeechRecognition();
recognition.lang = "hi-IN";
recognition.continuous = false;

// When user speaks
recognition.onresult = async (event) => {
  const text = event.results[0][0].transcript;
  document.getElementById("heard").innerText = "You: " + text;
  document.getElementById("status").innerText = "Thinkingâ€¦";

  // ðŸ”¥ Gemini API call
  const res = await fetch(
    `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_KEY}`,
    {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        contents: [
          {
            parts: [
              {
                text: `Reply like a caring girl best friend in Hindi/Hinglish:\n${text}`
              }
            ]
          }
        ]
      })
    }
  );

  const data = await res.json();
  const aiReply =
    data?.candidates?.[0]?.content?.parts?.[0]?.text ||
    "Hmmâ€¦ thoda soch rahi hoon ðŸ¤";

  document.getElementById("reply").innerText = "Bestie: " + aiReply;
  document.getElementById("status").innerText = "Done ðŸ’«";
};

document.body.addEventListener("click", () => {
  if (started) return;
  started = true;

  document.getElementById("status").innerText = "Speakingâ€¦";

  const msg = new SpeechSynthesisUtterance(
    "Heyâ€¦ tum aa gaye."
  );

  msg.lang = "hi-IN";
  msg.rate = 0.95;
  msg.pitch = 1.1;

  msg.onend = () => {
    document.getElementById("status").innerText = "Listeningâ€¦";
    recognition.start();
  };

  window.speechSynthesis.cancel();
  window.speechSynthesis.speak(msg);
});
</script>

</body>
</html>
